def get_charm(spell, wall_length=90):
    return [sum(1 for f in spell if i % f == 0) for i in range(1, wall_length+1)]

def get_spell(charm):
    spell = [1]
    for i in range(len(charm)):
        re = get_charm(spell, len(charm))
        c = [ai - bi for ai, bi in zip(charm,re)]
        idx = next((i for i, v in enumerate(c) if v > 0), None)
        if idx is None:
            return spell
        spell.append(idx + 1)

def block_needed(length, spell):
    return sum([length//x for x in spell])

def min_length_to_build(spell, have_blocks):
    lo, hi = 1, 10**20
    ans = -1
    while lo <= hi:
        mid = (lo + hi) // 2
        needed = block_needed(mid, spell)
        if needed > have_blocks:
            hi = mid - 1
        else:
            ans = mid
            lo = mid + 1
    return ans

part_1_input = [1,2,3,5,9]
part_1_input = [1,2,4,6,8,9,10,13,14,16,19,22,24,26,28,30,31,32,35,38,39]
print('Part A:', sum(get_charm(part_1_input)))
# print('Part A:', sum([90//x for x in part_1_input])) #alternative solution without charm function

part2_charm = [1,2,2,2,2,3,1,2,3,3,1,3,1,2,3,2,1,4,1,3,2,2,1,3,2,2]
part2_charm = [1,2,1,3,1,2,1,3,2,2,1,4,1,2,1,3,2,4,1,3,1,3,1,4,1,2,3,3,2,2,1,3,2,3,1,6,1,2,1,3,1,2,1,4,2,2,1,4,1,2,2,3,1,5,1,3,1,3,1,4,1,2,2,3,1,4,1,4,1,2,1,6,1,2,1,3,1,2,1,3,3,2,1,4,2,2,2,4,1,4,1,3,1,2,1,4,1,2,3,3,1,3,1,3,1,2,1,7,1,3,1,3,1,2,1,4,2,2,2,4,1,2,1,3,1,4,1,3,1,2,1,6,1,2,3,4,1,2,1,3,1,2,1,6,2,2,1,3,1,2,1,3,3,3,1,4,1,2,1,3,1,5,1,3,2,2,1,4,1,3,2,3,1,3,1,4,1,2,1,6,1,2,1,3,1,2,2,3,3,2,1,4,1,2,1,3,1,6,1,3,1,2,2,5,1,2,2,3,1,2,1,3,1,2,1,7,1,2,1,4,2,2,1,3,2,2,1,4,1,2,2,4,1,4,1,3,1,3,1,4,1,3,3,3,1,2,1,3,1,2,1,6,1,2,2,3]
import math
print('Part B:', math.prod(get_spell(part2_charm)))

part3_wall = [1,2,2,2,2,3,1,2,3,3,1,3,1,2,3,2,1,4,1,3,2,2,1,3,2,2]
part3_wall = [1,2,1,3,1,2,1,4,2,2,1,3,1,2,1,4,1,3,1,3,1,2,1,5,1,2,2,3,1,2,1,5,1,2,1,4,1,2,1,4,1,2,1,3,3,2,1,5,2,2,2,3,1,3,1,4,1,2,1,3,1,2,2,5,1,2,1,3,1,2,1,6,2,2,1,3,1,2,1,4,2,2,1,3,1,2,1,4,1,4,1,3,1,2,1,6,1,3,2,4,1,3,1,4,1,2,1,4,1,2,1,4,1,2,1,3,2,2,1,5,1,2,2,3,1,3,1,5,1,2,1,3,1,2,3,4,1,2,1,3,1,2,1,6,1,3,2,3,2,2,1,5,3,2,1,3,1,2,1,5,1,3,1,3,1,2,1,5,1,2,2,3,1,2,1,4,1,3,1,5,1,2,1,4,1,2,1,3,2,3,1,6,1,2,2,4,1,3,1,5,1,2,1,4,1,2,2,4,1,2,1,3,2,2,1,6,1,2,2,4,1,2,1,6,3,2,1,3,1,2,1,4,1,3,1,3,2,3,1,5,1,2,2,3,2,3,1,4,1,2,2,4,1,2,2,5,1,2,1,3,2,2,1,5,1,2,1,3,1,4,2,4,1,2,1,3,1,2,2,4,1,2,1,3,1,2,1,7,1,2,1,4,1,3,1,4,2,3,1,4,1,2,1,5,1,4,1,3,1,2,1,5,1,2,3,3,1,2,1,5,1,2,1,4,1,2,1,4,1,2,1,3,2,2,1,5,1,2,1,3,1,3,2,4,1,2,1,3,1,2,2,5,1,2,1,4,2,2,1,7,1,2,1,3,2,2,1,4,3,2,1,3,1,2,1,4,1,3,1,4,1,2,1,6,1,2,2,3,1,3,1,5,1,2,1,4,1,2,1,5,1,2,1,3,3,2,1,6,1,2,1,3,1,3,1,5,1,2,1,3,1,2,2,4,1,3,1,3,1,2,1,6,1,2,1,3,1,3,1,5,3,2,1,3,1,2,2,6,1,4,1,3,1,2,1,6,1,2,3,3,2,2,1,4,1,2,1,4,1,2,1,4,1,3,1,4,2,2,1,6,1,2,1,3,1,3,1,4,1,3,1,4,1,2,3,4,1,2,1,4,1,3,1,6,1,2,1,3,1,3,2,5,2,2,1,3,1,2,1,4,1,3,1,3,1,2,1,5,1,2,2,3,1,3,1,4,1,2,2,5,1,3,1,5,1,2,1,3,2,2,1,5,1,2,1,3,1,3,1,4,2,2,1,3,1,2,2,4,1,3,1,3,1,2,1,7,1,2,1,3,1,2,1,5,4,2,1,4,1,2,1,4,1,3,1,4,1,2,1,6,2,2,2,3,1,2,1,6,1,2,1,5,1,2,2,4,1,2,1,3,2,2,1,5,1,2,1,3,1,4,1,4,1,2,1,3,2,2,3,5,1,2,1,3,1,2,1,6,1,2,1,3,1,2,1,4,3,2,1,4,1,2,2,4,1,3,1,3,1,2,1,7,1,2,3,3,1,2,1,4,1,2,1,4,1,3,1,4,1,2,1,3,2,2,1,5,1,2,1,4,1,3,1,5,1,2,1,3,1,2,3,5,1,4,1,3,1,2,1,7,1,2,1,3,1,2,1,4,2,3,1,3,2,2,2,5,1,4,1,3,1,2,1,5,2,2,2,3,1,2,1,4,2,2,1,4,1,2,1,6,1,2,1,3,4,2,1,6,1,2,1,3,1,3,1,4,1,2,1,4,1,2,2,5,1,2,1,3,1,2,1,6,1,2,1,3,1,2,1,6,2,2,2,3,1,2,1,4,1,4,1,3,2,2,1,6,1,2,2,3,1,2,1,4,1,2,1,4,1,2,1,5,2,2,1,3,2,2,1,5,1,2,1,3,1,3,1,4,1,2,1,4,1,2,3,4,1,2,1,3,2,2,1,7,1,2,2,3,1,2,1,4,2,2,1,4,1,2,1,5,1,4,1,3,1,2,2,5,1,3,2,3,1,3,1,6,1,2,1,6,1,2,1,4,1,2,1,3,2,2,1,6,1,2,1,3,1,4,1,4,1,3,1,3,1,2,2,5,1,2,2,3,1,2,1,6,1,2,1,3,1,2,1,4,3,2,1,4,2,3,1,5,2,3,1,3,1,2,1,6,1,2,2,3,1,2,1,4,2,2,1,4,1,2,2,4,1,2,1,4,2,2,1,6,1,2,1,3,1,4,1,5,1,2,1,3,1,2,2,5]
print('Part C:', min_length_to_build(get_spell(part3_wall), 202520252025000))
